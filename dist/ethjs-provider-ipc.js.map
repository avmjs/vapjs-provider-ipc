{"version":3,"file":"ethjs-provider-ipc.js","sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap a4de66f1dab1b9623d14","webpack:///lib/index.js","webpack:///external \"net\""],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"net\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"IpcProvider\", [\"net\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"IpcProvider\"] = factory(require(\"net\"));\n\telse\n\t\troot[\"IpcProvider\"] = factory(root[\"net\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmory imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmory exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tObject.defineProperty(exports, name, {\n \t\t\tconfigurable: false,\n \t\t\tenumerable: true,\n \t\t\tget: getter\n \t\t});\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a4de66f1dab1b9623d14","/**\n * @original-authors:\n *   Marek Kotewicz <marek@ethdev.com>\n *   Marian Oancea <marian@ethdev.com>\n *   Fabian Vogelsteller <fabian@ethdev.com>\n * @date 2015\n */\nvar net = require('net');\n/**\n * InvalidResponseError helper for invalid errors.\n */\nfunction invalidResponseError(result, host) {\n  var message = !!result && !!result.error && !!result.error.message ? '[ethjs-provider-ipc] ' + result.error.message : '[ethjs-provider-ipc] Invalid JSON RPC response from host provider ' + host + ': ' + JSON.stringify(result, null, 2);\n  return new Error(message);\n}\n\n/**\n * IpcProvider should be used to send rpc calls over UNIX sockets.\n */\nfunction IpcProvider(path) {\n  if (!(this instanceof IpcProvider)) {\n    throw new Error('[ethjs-provider-ipc] the IpcProvider instance requires the \"new\" flag in order to function normally (e.g. `const eth = new Eth(new IpcProvider());`).');\n  }\n  if (typeof path !== 'string') {\n    throw new Error('[ethjs-provider-ipc] the IpcProvider instance requires that the path be specified (e.g. `/var/run/geth.ipc`)');\n  }\n\n  var self = this;\n  self.path = path;\n  self.responseCallbacks = {};\n}\n\n/**\n * Should be used to make async request\n *\n * @method sendAsync\n * @param {Object} payload\n * @param {Function} callback triggered on end with (err, result)\n */\nIpcProvider.prototype.sendAsync = function (payload, callback) {\n  // eslint-disable-line\n  var self = this;\n\n  try {\n    if (!self.connection || !self.connection.writeable) {\n      self.connection = net.connect(this.path);\n    }\n  } catch (error) {\n    callback(new Error('[ethjs-provider-ipc] CONNECTION ERROR: Couldn\\'t connect to path \\'' + self.path + '\\': ' + JSON.stringify(error, null, 2)), null);\n  }\n\n  self.connection.on('error', function (e) {\n    console.error('IPC Connection Error', e); // eslint-disable-line\n    callback(new Error('[ethjs-provider-ipc] CONNECTION TIMEOUT: request timeout. (i.e. your connect has timed out for whatever reason, check your provider).'), null);\n  });\n\n  self.connection.on('end', function (e) {\n    console.error('IPC Connection Closed', e); // eslint-disable-line\n    callback(new Error('[ethjs-provider-ipc] CONNECTION TIMEOUT: request timeout. (i.e. your connect has timed out for whatever reason, check your provider).'), null);\n  });\n\n  self.connection.on('data', function (data) {\n    var result = null;\n    try {\n      result = JSON.parse(data);\n      var _id = null;\n\n      if (Array.isArray(result)) {\n        result.forEach(function (load) {\n          if (self.responseCallbacks[load.id]) {\n            _id = load.id;\n          }\n        });\n      } else {\n        _id = result.id;\n      }\n\n      if (self.responseCallbacks[_id]) {\n        self.responseCallbacks[_id](null, result);\n        delete self.responseCallbacks[_id];\n      }\n    } catch (jsonError) {\n      callback(invalidResponseError(data, self.path), null);\n    }\n  });\n\n  var id = payload.id || payload[0].id;\n  self.responseCallbacks[id] = callback;\n\n  self.connection.write(JSON.stringify(payload));\n};\n\nmodule.exports = IpcProvider;\n\n\n// WEBPACK FOOTER //\n// lib/index.js","module.exports = require(\"net\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"net\"\n// module id = 1\n// module chunks = 0"],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACrDA;;;;;;;AAOA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AC3FA;;;;;;;;;;;;","sourceRoot":""}